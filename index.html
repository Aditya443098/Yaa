// Update state turnamen
let tournamentState = {
    active: false,
    player1Score: 0,
    player2Score: 0,
    targetWins: 4, // GANTI 3 MENJADI 4
    currentRound: 1,
    champion: null
};

// Update fungsi cek juara
function checkTournamentWinner() {
    if (tournamentState.player1Score >= tournamentState.targetWins) {
        tournamentState.champion = 'X';
        return 'X';
    } else if (tournamentState.player2Score >= tournamentState.targetWins) {
        tournamentState.champion = 'O';
        return 'O';
    }
    return null;
}

// Update fungsi startTournament
function startTournament() {
    tournamentState = {
        active: true,
        player1Score: 0,
        player2Score: 0,
        targetWins: 4, // GANTI DI SINI JUGA
        currentRound: 1,
        champion: null
    };
    
    // Update UI
    document.getElementById('tournament-display').style.display = 'block';
    document.getElementById('game-title').textContent = 'TURNAMEN - Round 1 (4 Wins)';
    
    // Reset game
    gameState.gameActive = true;
    gameState.currentTurn = 'X';
    gameState.board = Array(gameState.boardSize * gameState.boardSize).fill('');
    
    updateTournamentScore();
    initializeGameBoard();
    updateGameDisplay();
    saveTournamentState();
}

// Update fungsi handleCellClick bagian turnamen
if (tournamentState.active && winner && winner !== 'tie') {
    if (winner === 'X') {
        tournamentState.player1Score++;
    } else {
        tournamentState.player2Score++;
    }
    
    updateTournamentScore();
    
    // Cek apakah ada juara (4 kemenangan)
    if (tournamentState.player1Score >= tournamentState.targetWins || 
        tournamentState.player2Score >= tournamentState.targetWins) {
        
        tournamentState.champion = tournamentState.player1Score >= tournamentState.targetWins ? 'X' : 'O';
        showChampionModal(tournamentState.champion);
        tournamentState.active = false;
        
    } else {
        // Lanjut ke round berikutnya
        tournamentState.currentRound++;
        document.getElementById('game-title').textContent = `TURNAMEN - Round ${tournamentState.currentRound}`;
        
        setTimeout(() => {
            restartGame();
        }, 2000);
    }
}

// Update teks UI
document.querySelector('.tournament-card p').textContent = 'Menangkan 4 kali untuk menjadi juara!';
